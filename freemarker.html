<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<title>Freemarker Templates</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="./asciidoctor.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_freemarker_templates">1. Freemarker Templates</a>
<ul class="sectlevel2">
<li><a href="#_why_freemarker">1.1. Why Freemarker ?</a></li>
<li><a href="#_rendering_templates">1.2. Rendering templates</a></li>
<li><a href="#_injecting_templates">1.3. Injecting templates</a></li>
<li><a href="#_internationalization_support">1.4. Internationalization support</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_freemarker_templates">1. Freemarker Templates</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_why_freemarker">1.1. Why Freemarker ?</h3>
<div class="paragraph">
<p>During our migration to Quarkus, we tried to reimplement our Freemarker components with Qute, the template engine proposed but the Quarkus team. But it was lacking some features needed for it. As the components base was already well-defined and stable, the choice have been made to continue using Freemarker. <strong>The downsides will be the lack of reactive support (but not intended for Weblith) and the native build support that seems hard to get working.</strong></p>
</div>
</div>
<div class="sect2">
<h3 id="_rendering_templates">1.2. Rendering templates</h3>
<div class="paragraph">
<p>Simply return a <code>HtmlResult</code> to render Freemarker template. This result must point to a template name, and a directory (or the controller name, by default).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">    @Get("/")
    public HtmlResult home() {
        return new HtmlResult("Main", "home").render("MyData","MyValue");
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will render the template <code>templates/Main/home.ftlh</code> (stored in the classpath, so in <code>src/main/resources</code>), with a <code>MyData</code> available variable. Some default variables are always added by Weblith :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>hostname</code>, <code>requesPath</code> and <code>params</code> : relative to the current request</p>
</li>
<li>
<p><code>contextPath</code> : value of <code>quarkus.http.root-path</code></p>
</li>
<li>
<p><code>lang</code> : current used defined language</p>
</li>
<li>
<p><code>flash</code> : map with current Flash scope data</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Refer to the [Freemarker](<a href="https://freemarker.apache.org/docs/index.html" class="bare">https://freemarker.apache.org/docs/index.html</a>) documentation for more information about how to use this engine.</p>
</div>
</div>
<div class="sect2">
<h3 id="_injecting_templates">1.3. Injecting templates</h3>
<div class="paragraph">
<p>A better way to use templates is to inject instances of <code>FreemarkerTemplate</code> in the controllers. This way, template paths are checked at build-time.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Controller
public class SimpleEntityController {

    @Inject
    FreemarkerTemplate list;

    @Get
    public HtmlResult list() {
        return list.render("SimpleEntities", SimpleEntity.listAll());
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The path of the template will automatically set to <code>templates/SimpleEntityController/list.ftlh</code>. It can be changed by using the <code>@TemplatePath</code> annotation.</p>
</div>
</div>
<div class="sect2">
<h3 id="_internationalization_support">1.4. Internationalization support</h3>
<div class="paragraph">
<p><code>quarkus.locales</code> can be set to the locales supported by the application, and <code>quarkus.default-locale</code> to the default one. Then <code>messages.properties</code> files can be configure in a <code>i18n</code> directory (stored in the classpath, so in <code>src/main/resources</code>). A Weblith <code>LocaleHandler</code> will be used to detect the right language to use, but can be switched by passing a <code>lang</code> parameter to any request (can be changed via <code>quarkus.weblith.switchLanguageParam</code>).</p>
</div>
<div class="paragraph">
<p>While a <code>Messages</code> interface can be injected in any controller of internal service, two methods are also available in the templates :
 * <code>i18n(key,param1,param2,&#8230;&#8203;)</code> : translates the given key
 * <code>prettyTime(date)</code> : displays date relatively</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 0.1.1-SNAPSHOT<br>
Last updated 2020-11-29 20:51:28 UTC
</div>
</div>
</body>
</html>